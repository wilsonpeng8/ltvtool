<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title>Ltvtool by wilsonpeng8</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="stylesheets/normalize.css" media="screen">
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">

  </head>
 
    <section class="page-header">
      <h1 class="project-name">Ltvtool</h1>
      <h2 class="project-tagline">ltv tool</h2>
    
    </section>

    <section class="main-content">

  <!--<script src="script.js"></script>-->

  <script>
    var calculateClv = function(a, b, c, d, e, f) {
      c = c ? c : 30, d = d ? d : 1, e = e ? e : 0, f = f ? f : 0;
      var g = -1 * f,
        h = 0,
        j = a * d,
        k = Math.pow(1 - e, 1 / 365),
        l = 1825,
        m = [],
        n = 0;
      for (i = 0; l > i; i++) i % c == 0 && (j = a * d, j *= Math.pow(b, n), j *= Math.pow(k, h), g += j, m.push(g), h += c, n++);
      return m
    }

    var calc = function() {

      var averageOrderValue = parseFloat($("#averageOrderValue").val());
      var repeatPurchaseRate = parseFloat($("#repeatPurchaseRate").val()) / 100;
      var timeBetweenPurchases = parseInt($("#timeBetweenPurchases").val());
      var grossMargin = parseFloat($("#grossMargin").val()) / 100;
      var costOfCapital = parseFloat($("#costOfCapital").val()) / 100;
      var customerAcquisitionCost = parseFloat($("#customerAcquisitionCost").val());
      var clvSeries = calculateClv(averageOrderValue, repeatPurchaseRate, timeBetweenPurchases, grossMargin, costOfCapital, customerAcquisitionCost);
      var rpr10 = repeatPurchaseRate + .1 * (1 - repeatPurchaseRate);
      var rpr20 = repeatPurchaseRate + .2 * (1 - repeatPurchaseRate);
      var rpr30 = repeatPurchaseRate + .3 * (1 - repeatPurchaseRate);
      var clv_rpr_10 = calculateClv(averageOrderValue, rpr10, timeBetweenPurchases, grossMargin, costOfCapital, customerAcquisitionCost);
      var clv_rpr_20 = calculateClv(averageOrderValue, rpr20, timeBetweenPurchases, grossMargin, costOfCapital, customerAcquisitionCost);
      var clv_rpr_30 = calculateClv(averageOrderValue, rpr30, timeBetweenPurchases, grossMargin, costOfCapital, customerAcquisitionCost);
      var aov10 = averageOrderValue + .1 * averageOrderValue;
      var aov20 = averageOrderValue + .2 * averageOrderValue;
      var aov30 = averageOrderValue + .3 * averageOrderValue;
      var clv_aov_10 = calculateClv(aov10, repeatPurchaseRate, timeBetweenPurchases, grossMargin, costOfCapital, customerAcquisitionCost);
      var clv_aov_20 = calculateClv(aov20, repeatPurchaseRate, timeBetweenPurchases, grossMargin, costOfCapital, customerAcquisitionCost);
      var clv_aov_30 = calculateClv(aov30, repeatPurchaseRate, timeBetweenPurchases, grossMargin, costOfCapital, customerAcquisitionCost);
      debugger;
      var computed_clv = clvSeries[clvSeries.length - 1];
      $('#valMachine').html(computed_clv);
      //alert(computed_clv.formatMoney(2))
    };

    $(document).ready(function() {
      $('#btnCalculate').click(function() {
        calc();
        //alert('calculate');
        /** var averageOrderValue = parseFloat($("#avgOrderValue").val());
            var repeatPurchaseRate = parseFloat($("#repurchaseRate").val()) / 100;
            var timeBetweenPurchases = parseInt($("#timeBetweenPurchases").val());
            var grossMargin = parseFloat($("#grossMargin").val()) / 100;
            var costOfCapital = parseFloat($("#costOfCapital").val()) / 100;
            var customerAcquisitionCost = parseFloat($("#customerAcquisitionCost").val());
            //var clvSeries = calculateClv(averageOrderValue, repeatPurchaseRate, timeBetweenPurchases, grossMargin, costOfCapital, customerAcquisitionCost);*/
        //alert(clvSeries);
        
        

      });
    });
  </script>
</head>


<body>
  average Order Value
  <input type="text" id="averageOrderValue" placeholder="averageOrderValue">
  <br>repeat Purchase Rate
  <input type="text" id="repeatPurchaseRate" placeholder="repeatPurchaseRate">
  <br>time Between Purchases
  <input type="text" id="timeBetweenPurchases" placeholder="timeBetweenPurchases">
  <br>gross Margin
  <input type="text" id="grossMargin" placeholder="grossMargin">
  <br>cost Of Capital
  <input type="text" id="costOfCapital" placeholder="costOfCapital">
  <br>customer Acquisition Cost
  <input type="text" id="customerAcquisitionCost" placeholder="customerAcquisitionCost">
  <br>


  <input type="button" class= "btn btn-primary" id="btnCalculate" value="calculate">
  
  <div id="valMachine"></div>
</body>




      <footer class="site-footer">
        <span class="site-footer-owner"><a href="https://github.com/wilsonpeng8/ltvtool">Ltvtool</a> is maintained by <a href="https://github.com/wilsonpeng8">wilsonpeng8</a>.</span>

        <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the <a href="https://github.com/jasonlong/cayman-theme">Cayman theme</a> by <a href="https://twitter.com/jasonlong">Jason Long</a>.</span>
      </footer>

    </section>

  
  
</html>

